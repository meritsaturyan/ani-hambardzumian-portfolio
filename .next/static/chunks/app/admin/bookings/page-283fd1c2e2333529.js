(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[424],{323:function(e,t,s){Promise.resolve().then(s.bind(s,8379))},6463:function(e,t,s){"use strict";var n=s(1169);s.o(n,"usePathname")&&s.d(t,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(t,{useRouter:function(){return n.useRouter}}),s.o(n,"useSearchParams")&&s.d(t,{useSearchParams:function(){return n.useSearchParams}})},8379:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var n=s(7437),a=s(2265),i=s(6463),r=s(6499),l=s(4319);function c(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),[s,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[x,u]=(0,a.useState)("");return(0,a.useEffect)(()=>{c(t.get("from")||""),d(t.get("to")||""),u(t.get("pavilionId")||"")},[t]),(0,n.jsxs)("form",{onSubmit:function(t){t.preventDefault();let n=new URLSearchParams;s&&n.set("from",s),o&&n.set("to",o),x&&n.set("pavilionId",x);let a=n.toString();e.push("/admin/bookings".concat(a?"?"+a:""))},className:"flex flex-wrap gap-3 items-end bg-white/5 border border-white/10 rounded-2xl p-4 text-xs",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-[140px]",children:[(0,n.jsx)("label",{className:"text-[11px] uppercase tracking-[0.16em] text-white/50",children:"From date"}),(0,n.jsx)(r.Z,{type:"date",value:s,onChange:e=>c(e.target.value)})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-[140px]",children:[(0,n.jsx)("label",{className:"text-[11px] uppercase tracking-[0.16em] text-white/50",children:"To date"}),(0,n.jsx)(r.Z,{type:"date",value:o,onChange:e=>d(e.target.value)})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-1 min-w-[140px]",children:[(0,n.jsx)("label",{className:"text-[11px] uppercase tracking-[0.16em] text-white/50",children:"Pavilion ID"}),(0,n.jsx)(r.Z,{type:"number",min:1,value:x,onChange:e=>u(e.target.value),placeholder:"Any"})]}),(0,n.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,n.jsx)(l.Z,{type:"submit",size:"sm",children:"Apply"}),(0,n.jsx)(l.Z,{type:"button",variant:"ghost",size:"sm",onClick:function(){c(""),d(""),u(""),e.push("/admin/bookings")},children:"Reset"})]})]})}function o(e){let{bookings:t,loading:s,onSelectBooking:a,onStatusChanged:i}=e;async function r(e,t){try{(await fetch("/api/bookings/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok?null==i||i():console.error("Failed to update status")}catch(e){console.error("Failed to update status",e)}}return(0,n.jsx)("div",{className:"rounded-2xl border border-white/10 bg-white/5 overflow-hidden",children:(0,n.jsx)("div",{className:"max-h-[480px] overflow-auto",children:(0,n.jsxs)("table",{className:"w-full text-xs md:text-sm",children:[(0,n.jsx)("thead",{className:"bg-white/5 text-white/60",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Date"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Time"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Pavilion"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Customer"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Contacts"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Total"}),(0,n.jsx)("th",{className:"px-3 py-2 text-left",children:"Status"}),(0,n.jsx)("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),(0,n.jsxs)("tbody",{children:[s&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:8,className:"px-3 py-4 text-center text-white/60",children:"Loading..."})}),!s&&0===t.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:8,className:"px-3 py-4 text-center text-white/60",children:"No bookings found."})}),t.map(e=>(0,n.jsxs)("tr",{className:"border-t border-white/10",children:[(0,n.jsx)("td",{className:"px-3 py-2",children:new Date(e.date).toLocaleDateString("en-GB")}),(0,n.jsxs)("td",{className:"px-3 py-2",children:[e.start_time," – ",e.end_time]}),(0,n.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:[e.pavilion_name," (#",e.pavilion_id,")"]}),(0,n.jsx)("td",{className:"px-3 py-2",children:e.customer_name}),(0,n.jsxs)("td",{className:"px-3 py-2 whitespace-nowrap",children:[(0,n.jsx)("div",{children:e.phone}),(0,n.jsx)("div",{className:"text-white/60",children:e.email})]}),(0,n.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:new Intl.NumberFormat("hy-AM",{style:"currency",currency:"AMD",maximumFractionDigits:0}).format(e.total_price||0)}),(0,n.jsx)("td",{className:"px-3 py-2 capitalize",children:e.status}),(0,n.jsxs)("td",{className:"px-3 py-2 text-right space-x-1",children:[(0,n.jsx)(l.Z,{size:"xs",variant:"ghost",onClick:()=>null==a?void 0:a(e),children:"View"}),(0,n.jsx)(l.Z,{size:"xs",variant:"confirmed"===e.status?"ghost":"outline",onClick:()=>r(e.id,"confirmed"),children:"Confirm"}),(0,n.jsx)(l.Z,{size:"xs",variant:"cancelled"===e.status?"ghost":"outline",onClick:()=>r(e.id,"cancelled"),children:"Cancel"})]})]},e.id))]})]})})})}function d(e){let{booking:t,onClose:s}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:(0,n.jsxs)("div",{className:"bg-brand-bg border border-white/15 rounded-2xl shadow-soft max-w-md w-full mx-4 p-5 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Booking details"}),(0,n.jsx)("button",{type:"button",onClick:s,className:"text-white/60 hover:text-white text-xs",children:"Close"})]}),(0,n.jsxs)("div",{className:"space-y-2 text-xs md:text-sm",children:[(0,n.jsxs)(x,{label:"Pavilion",children:[t.pavilion_name," (#",t.pavilion_id,")"]}),(0,n.jsxs)(x,{label:"Date",children:[new Date(t.date).toLocaleDateString("en-GB")," \xb7"," ",t.start_time,"–",t.end_time]}),(0,n.jsx)(x,{label:"Customer",children:t.customer_name}),(0,n.jsx)(x,{label:"Phone",children:t.phone}),(0,n.jsx)(x,{label:"Email",children:t.email}),(0,n.jsx)(x,{label:"Total",children:new Intl.NumberFormat("hy-AM",{style:"currency",currency:"AMD",maximumFractionDigits:0}).format(t.total_price||0)}),(0,n.jsx)(x,{label:"Status",valueClass:"capitalize",children:t.status}),t.notes&&(0,n.jsx)(x,{label:"Notes",children:t.notes}),t.extras&&(0,n.jsx)(x,{label:"Extras",children:(0,n.jsx)("pre",{className:"whitespace-pre-wrap text-xs",children:JSON.stringify(t.extras,null,2)})})]}),(0,n.jsx)("div",{className:"mt-4 text-right",children:(0,n.jsx)(l.Z,{size:"sm",variant:"ghost",onClick:s,children:"Close"})})]})}):null}function x(e){let{label:t,children:s,valueClass:a}=e;return(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{className:"w-24 text-white/50 text-xs uppercase tracking-[0.16em]",children:t}),(0,n.jsx)("div",{className:"flex-1 ".concat(a||""),children:s})]})}var u=s(7994);function h(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),[s,r]=(0,a.useState)([]),[l,x]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null);async function b(){m(!0),x("");try{let s=new URLSearchParams(t.toString()),n=await fetch("/api/bookings?".concat(s.toString()),{credentials:"include"});if(401===n.status){e.push("/admin/login");return}if(!n.ok){let e=await n.json().catch(()=>({}));x(e.error||"Failed to load bookings");return}let a=await n.json();r(a.bookings||[])}catch(e){x("Failed to load bookings")}finally{m(!1)}}return(0,a.useEffect)(()=>{b()},[t.toString()]),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-semibold",children:"Bookings"}),(0,n.jsx)("p",{className:"text-white/60 mt-1",children:"Manage studio bookings, confirm or cancel requests."})]}),(0,n.jsx)(c,{}),l&&(0,n.jsx)(u.Z,{variant:"error",children:l}),(0,n.jsx)(o,{bookings:s,loading:h,onSelectBooking:f,onStatusChanged:b}),p&&(0,n.jsx)(d,{booking:p,onClose:()=>f(null)})]})}function m(){return(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-semibold",children:"Bookings"}),(0,n.jsx)("p",{className:"text-white/60 mt-1",children:"Loading bookings, please wait..."})]})}),children:(0,n.jsx)(h,{})})}},7994:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var n=s(7437),a=s(4839);let i={error:"border-red-400/60 bg-red-500/10 text-red-100",success:"border-emerald-400/60 bg-emerald-500/10 text-emerald-100",info:"border-brand.accent/60 bg-brand.accent/10 text-brand.accent"};function r(e){let{children:t,variant:s="info",className:r}=e;return(0,n.jsx)("div",{className:(0,a.Z)("rounded-xl border px-3 py-2 text-xs md:text-sm",i[s],r),children:t})}},4319:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var n=s(7437),a=s(4839);let i={solid:"bg-brand.primary text-black hover:bg-brand.primaryDark",outline:"border border-white/30 text-white hover:bg-white/10",ghost:"text-white/70 hover:bg-white/10"},r={sm:"px-3 py-1.5",md:"px-4 py-2",xs:"px-2 py-1 text-[11px]"};function l(e){let{children:t,variant:s="solid",size:l="md",className:c,...o}=e;return(0,n.jsx)("button",{className:(0,a.Z)("inline-flex items-center justify-center rounded-full text-xs md:text-sm font-medium transition focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-black",i[s],r[l],c),...o,children:t})}},6499:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(7437);function a(e){let{className:t="",...s}=e;return(0,n.jsx)("input",{className:"w-full bg-black/40 border border-white/15 rounded-xl px-3 py-2 text-sm outline-none focus:border-brand.primary focus:ring-1 focus:ring-brand.primary ".concat(t),...s})}},4839:function(e,t,s){"use strict";t.Z=function(){for(var e,t,s=0,n="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(n=e(t[s]))&&(a&&(a+=" "),a+=n)}else for(n in t)t[n]&&(a&&(a+=" "),a+=n)}return a}(e))&&(n&&(n+=" "),n+=t);return n}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=323)}),_N_E=e.O()}]);